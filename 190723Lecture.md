### ***용어 /약자***

- **DLP** ( *Data Loss Prevention* ) : 데이터 유출 방지, 기업 내에서 주로 사용 (문서 보안)

- **DRM** ( *Digital Rights Management* ) 

- **CSRF**(*크로스 사이트 요청 위조*) : 서버로 전달된 요청을 요청 절차와 주체에 대한 검증을 수행하지 않고 요청을 처리했을 때 발생 

- **Referer** : 요청이 발생한 위치

- **Redirect** : 클라이언트의 요청을 다른 곳으로 요청하는 것

- **BoF** : Buffer OverFlow

- **File Download** : 특정 디렉토리에 존재하는 파일을 내려주는 서비스

  `…/download.jsp?filename=abc.gif`

  `new File("/data/upload/"+filename);`

  `…/download.jsp?filename=../../../../../etc/passwd;`   => 시스템 디렉토리(접근할 수 없는 디렉토리와 파일)까지 접근이 가능하다. => 경로 조작

- Hash를 할땐 "Salt"를 꼭 해야하는데 크래킹을 방어하는 시스템 임의의 값이다.

- **동적분석** - 실행파일의 결과(값,성능,보안)를 보고 판정하는 분석형태 (Black Box) => 디버깅, 부하테스트, 모의해킹(침투 테스트)

- **정적분석** - 소스코드를 보고 소스의 형태, 구문, 내용을 보고 판정하는 분석형태 ( White Box ) => 코드리뷰

# Java 시큐어 코딩

### 운영체제 명령어 삽입 (Command Injection)

- 운영체제 명령어 실행 부분이 존재하는 경우,
  외부 입력값을 검증, 제한 없이 운영체제 명령어 실행 부분에 *운영체제 명령어* 또는 *명령어의 일부*로 사용되는 경우 발생한다.

  

  //  외부 입력값을 검증 제한 없이 명령어로 사용하는 경우

  //  …/doSomething.jsp?cmd=dir    =>서버에서 dir한 결과가 반환

  //  의도하지 않은 명령어가 전달되어서 실행될 수 있다.  => 서버 제어권이 공격자에게 넘어감.

  //   …/doSomething.jsp?cmd=ipconfig

  `String input = request.getParameter("cmd");
  Runtime.getRuntime().exec(input);`

  

  //   외부 입력값을 검증 제한 없이 명령어의 일부로 사용하는 경우

  //   …/doSomething.jsp?fname=help.txt    => c:\data\help.txt 내용이 화면에 출력

  //   …/doSomething.jsp?fname=help.txt %26 ipconfig.      =>의도하지 않은 추가 명령어가 실행된다.(%26=&)

  `String input = request.getParameter("fname");
  Runtime.getRuntime().exec("type c:\data\"+input);`

  

### 파일 업로드 취약점

- 파일의 크기, 종류를 제한하지 않았을 경우
  - 크기 : 서버의 Storage 자원 고갈, 서버의 연결 자원 고갈 => 정상적인 서비스를 방해
  - 종류 : 서버에서 실행되는 파일이 업로드 될 수 있음  => 서버 제어권 탈취 가능
              Client에서 실행되는 파일이 업로드 될 수 있음  => 악성코드의 유포지로 활용 될 수 있음

### Password

1) 생성, 변경 규칙 

- 영문, 숫자, 특수문자 조합 8자리 이상 / 2가지종류 10자리 이상 
- 사전에 등록된 PW 사용 금지
- 규칙성 X
- 개인의 정보와 관련된 것 금지

2) 저장 , 보관 시

- 암호화(해쉬) -> 일정한 크기의 유일한 값으로 암호화 하는것이 해쉬
- 해쉬의 가장 큰 특징 => 단방향 / 고정길이 / 유일성
- 해쉬함수를 쓰는 이유는 내부 관리자(Admin)도 알지 못하게 하기 위해
- 암호화는 가능한데 복호화가 불가능 하기 때문에 해쉬함수를 사용한다.

3) 관리정책 

- 변경주기
- History 관리
- 최소 사용 기간



## 3. 보안취약점 정보 활용

### CWE

- Common Weakness(약점) Enumeration 
- 약점 : 가능성을 건의

### CVE

- Common Vulnerabilities(취약점) and Exposures
- 취약점 : 원인을 가지고 결과적으로 찾음.
- CVE-ID 형식 : CVE-해당년도-일련번호 (예 : CVE-2019-0001)

### CWSS

- CWE를 채점하기 위한 시스템
- 정량화, 객관화

### SANS TOP 25 Most Dangerous Software Errors

- SANS (*SysAdmin, Audit, Network, Security*)에서 가장 위험한 25가지 소프트웨어 오류를 정리한 목록이다.

- 시대가 바뀌면 환경이 바뀌므로 순위는 계속해서 바뀔 수 있다.

- 3개의 카테고리로 분류

  1) 구성요소간 안전하지 않은 상호작용(6개).    //SQL Injection, ...

  | 순위 | CWE ID  | 설명                                                         |
  | :--: | :-----: | :----------------------------------------------------------- |
  |  1   | CWE-89  | SQL 명령에 사용된 특별한 엘리먼트를 무효화하지 않는 것(SQL Injection) |
  |  2   | CWE-78  | 운영체제 명령에 사용된 특별한 엘리먼트를 무효화하지 않는 것(Command Injection) |
  |  4   | CWE-79  | 웹 페이지 생성 도중 입력 값을 무효화하지 않는 것(XSS)        |
  |  9   | CWE-434 | 위험한 유형의 파일 업로드를 제한하지 않는 것                 |
  |  12  | CWE-352 | 사이트간 요청 위조 ( CSRF : Cross-Site Request Forgery )     |
  |  22  | CWE-601 | 신뢰할 수 없는 사이트로 URL 접속지 변경하는 것( Open Redirect ) |

  2) 위험한 자원관리(8개).     //서버가 가지고 있는 파일들을 가져오기...

   : 소프트웨어가 *중요한 시스템 자원을 적절하게 생성, 사용, 전송, 폐기하지 않는 것*과 관련이 있는 취약점을 정의

  | 순위 | CWE ID  | 설명                                                         |
  | :--: | :-----: | ------------------------------------------------------------ |
  |  3   | CWE-120 | 입력의 크기를 확인하지 않고 버퍼 복사하는 것( 전통적인 버퍼 오버플로우) |
  |  13  | CWE-22  | 금지된 디렉토리에 접근을 제한하지 않는 것( 경로 추적 )       |
  |  14  | CWE-494 | 무결성 검사 없이 코드 다운로드하는 것                        |
  |  16  | CWE-829 | 신뢰할 수 없는 제어 영역에서 온 기능을 포함하는 것           |
  |  18  | CWE-676 | 잠재적으로 위험한 함수를 사용하는 것                         |
  |  20  | CWE-131 | 버퍼 크기를 잘못 계산하는 것                                 |
  |  23  | CWE-134 | 형식 문자열(Format String)을 통제하지 않는 것                |
  |  24  | CWE-190 | 정수 오버플로우 또는 랩어라운드 ( Integer Overflow or Wraparound ) |

  3) 허점이 많은 방어(11개).    //방어를 했는데 잘 구현되지 않음….

   : *오.남용하거나 쉽게 무시되는 방어 기법과 관련*이 있는 취약점을 정의

  | 순위 | CWE ID  | 설명                                                     |
  | :--: | :-----: | -------------------------------------------------------- |
  |  5   | CWE-306 | 핵심 기능에 대해서 인증을 누락하는 것                    |
  |  6   | CWE-862 | 인가 기능을 누락                                         |
  |  7   | CWE-798 | 인증에 사용되는 데이터를 코드에 직접 기록하는 것         |
  |  8   | CWE-311 | 민감한 데이터에 함호화 누락하는 것                       |
  |  10  | CWE-807 | 신뢰할 수 없는 입력 정보에 의존하여 보안성 결정하는 것   |
  |  11  | CWE-250 | 불필요한 권한으로 실행하는 것                            |
  |  15  | CWE-863 | 올바르지 않은 인가                                       |
  |  17  | CWE-732 | 중요한 자원에 잘못된 권한을 할당하는 것                  |
  |  19  | CWE-327 | 해독되었거나 위험한 암호화 알고리즘 사용하는 것          |
  |  21  | CWE-307 | 과도한 인증 시도를 제한하지 않는 것 (인증시도 횟수 제한) |
  |  25  | CWE-759 | 솔트(Salt) 없이 일방향 해쉬를 사용하는 것                |

  

  ### OWASP TOP 10

  - 운영 중인 웹 서버에서 가장 많이 발생하는 침해 사고 유형을 정리한 리스트

  - OWASP( *Open Web Application Security Project* )에 의해서 유지, 발표

    TOP10 -2019

    1) Injection ( 인젝션 )

    2) Broken Authentication ( 인증 및 세션 관리 취약점 )

    3) Sensitive data exposure ( 민감 데이터 노출 )

    4) XML External Entities ( XEE )

    5) Broken Access control 

    6) Security misconfigurations ( 보안 설정 오류 )

    7) Cross-Site Scripting( XSS ) ( 크로스 사이트 요청 변조 )

    8) Insecure Deserialization( 안전하지 않은 암호 저장 )

    9) Using Components with known vulnerabilities

    10) Insufficient logging and monitoring



## CH.2 개발 보안 방법론

### SW개발 보안이란?

- 안전한 SW 개발을 위해 소스코드 등에 존재할 수 있는 잠재적인 보안약점을 제거하고, 보안을 고려하여 기능을 설계,구현 하는 등 SW개발 과정에서 실행되는 일련의 보안활동
  - 요구사항 분석
  - 설계
  - 구현⭐️
  - 테스트

### 왜 SW 개발단계부터 보안 취약점을 제거해야 하는가?

- 출시 이전 SW 취약점을 50% 줄이면, 침해사고 대응 비용 75% 감소 - Garther
- 보안 취약점의 92%는 네트워크가 아닌 애플리케이션에서 발견 - NIST
- 출시 이후 오류 수정은 약 \$30,000의 비용 소요 , 하지만 개발 중 오류 수정은 약 \$5,000면 충분 - NIST
- 출시 이후 오류를 수정하고자 할 경우 설계 단계보다 비용 100배 증가 - IBM

